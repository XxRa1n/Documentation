# Git教程廖雪峰
### 0.Git简介
Git是一个开源的分布式版本控制系统,可以有效、高速地处理从很小到非常大的项目版本管理.
Git由本地仓库和Github这样的服务器组成,本地仓库和服务器上都存有整个项目的完整备份.
Git还会记录每次提交的更改,方面在发生bug的时候进行项目回退

### 一.Git的安装
Linux:使用对应的包管理命令(apt-get，yum等)可以直接安装.
Windows:下载git并配置完环境变量,就可以在cmd中使用.

安装完Git之后需要配置自己的ID(name and email)
```
$ git config --global user.name "Your Name"
$ git config --global user.email "email@example.com"
```
### 二.建立和删除本地仓库
在目标文件夹下使用
```
$ git init
```
会自动生成一个.git的隐藏目录,代表以这个文件夹为目录的本地仓库已经生成完毕.
删除.git目录即删除本地仓库.

### 三.向本地仓库中添加文件并提交
1.  首先创建需要添加的文件,例如:1.txt,2.txt
2.  把两个文件添加到暂存区
```
$ git add 1.txt
$ git add 2.txt
```
3.  将暂存区的文件添加到本地仓库中.
```
$ git commit -m "add 1.txt and 2.txt" 
(双引号中的是本地提交的说明，可以自定义)
```
补充说明：
Git不会自动把仓库文件夹中所有文件都默认添加到仓库中去,需要手动add然后commit。在commit提交之前可以多次add。

### 四.Git项目版本回退
#### 4.1Git版本管理方式
在学习如何利用Git进行版本回退之前,需要对Git如何管理项目版本有大概的了解.
类似于链表,Git有一个名为HEAD的指针指向当前的项目版本,当前的项目版本指向上一个项目版本,以此类推.Git进行回退操作的时候,就相当于移动HEAD指针在链表中的位置.
#### 4.2Log日志和版本回退
输入
```
$ git log
```
可以查看历史版本的提交信息，找到想要回退到的版本号。
通过reset命令就可以实现回退
```
$ git reset --hard [版本号]
```
版本号可以只写前几位,只要能区分就行
#### 4.3reflog与操作撤销
如果发生了误操作的情况,比如不小心把项目回退到好几个版本之前.想要恢复到最新版,却又不知道最新版的版本号.
这个时候使用log命令就行不通了,log命令只记录当前版本和之前版本的信息.
需要reflog命令来应对这种问题.reflog记录你之前的操作,就像undo或者`Ctrl+Z`一样,可以顺着它回溯之前的操作.在reflog日志中找到最新版的版本号就可以用reset恢复了.

### 五.工作区、暂存区和版本库
创建Git的根目录,也就是执行`git init`的目录是工作区.
自动创建的`.git`目录是版本库.
版本库中记录着很多信息,版本库中又包含暂存区和分支.
Git会为我们自动创建master分支.
add命令会把工作区中的文件添加到暂存区;
commmit命令会把暂存区中的文件提交到分支中,默认是master分支.
可以通过`git status`查看各区工作情况.

### 六.管理修改
Git记录并管理的是文件的改动,而不是文件本身.
例如:
```
1.创建test.txt文件
2.修改test.txt文件(第一次)
3.git add text.txt
4.修改text.txt文件(第二次)
5.git commit -m "commit test.txt"
```
此时master分支中存储的是第一次修改后的文件,而不是第二次修改后的.因为只有第一次修改被add进了暂存区.

### 七.撤销修改
开发人员对文件进行了一次错误的修改,此时文件还没有被commit提交,可以撤销此前的修改.
具体有如下两种情况:
#### 7.1仅在工作区中修改文件,并未add到暂存区
```
$ git checkout -- [filename]
例如:
$ git checkout -- readme.txt
```
使用checkout命令可以撤销工作区中的修改，是文件回到和版本库中一样的状态.
> 我自己的理解:checkout命令就是用版本库中的文件覆盖本地的文件,以实现同步的目的.
#### 7.2工作区中的修改add到暂存区中,且并未commit
先使用reset命令,把修改从暂存区回退到工作区.
```
$ git reset HEAD <file>
例如：
$ git reset HEAD readme.txt
```
然后用checkout撤销工作区中的修改.

### 八.删除文件
删除文件分三步:
1.  工作区中删除文件
2.  `$ git rm [filename]`将删除提交到暂存区(就像add命令一样)
3.  `$ git commit -m "remove"`提交修改到版本库

### 九.远程库
使用`Git init`我们创建了本地仓库,为了方便开发管理,可以在Github也创建一个Git仓库,并将两个仓库进行同步.
#### 9.1在Github上创建一个仓库
1.  注册登录Github
2.  Create a new repo
#### 9.2把本地仓库与远程仓库关联起来
在本地仓库目录下输入:
```
$ git remote add [远程仓库自定义名称,默认使用origin] git@github.com:[Github账户名]/[Git仓库名].git
```
`Git remote`就是对远程仓库进行操作.
`add [远程仓库自定义名称,默认使用origin]`就是在本地注册一个远程仓库,名称是自定义.
`git@github.com:[Github账户名]/[Git仓库名].git`是远程仓库的地址,前面自定义的名称相当于这个仓库的本地别名.
#### 9.3 SSH key
本地仓库和远程仓库使用SSH协议传输文件,需要SSH key实现登录验证.
在本地先生成ssh key:
```
$ ssh-keygen -t rsa -C "your_email@example.com"
```
- t 指定密钥类型，默认是 rsa ，可以省略。
- C 设置注释文字，比如邮箱。
- f 指定密钥文件存储文件名。

找到新生成的ssh key,添加到github上.
#### 9.4将本地仓库中的文件推送到远程库上
```
$ git push -u origin [分支名]
把本地仓库中的分支推送到origin(远程服务器默认名称)的分支上
```
首次推送需要添加参数`-u`,Git会将两个分支关联起来.
后续再推送的时候就不需要添加了:
```
$ git push origin [分支名]
```
#### 9.5删除远程仓库
先查看远程库信息:
```
$ git remote -v
```
然后删除远程仓库:
```
$ git remote rm [远程库名称]
```

#### 9.6从远程库克隆
使用clone命令:
```
$ git clone git@github.com:[Github账户名]/[Git仓库名].git
```
会把Github上的仓库克隆到本地

### 十.分支管理
Git的管理的项目版本就像链表一样串联在一起.
Git仓库除了master分支,还可以创建其他分支.每个分支就相当于一个指针,指向链表的某一个节点.
Git的HEAD指针指向当前的工作分支,在master分支上工作就指向master分支,在dev分支上工作就切换到dev分支上.
#### 10.1查看分支
```
$ git branch
```
#### 10.2创建分支
```
$ git branch [分支名]
```
#### 10.3切换分支
```
$ git switch [分支名]
可以使用:
$ git checkout [分支名]
```
创建并切换到目标分支：
```
$ git switch -c [分支名]
或者
$ git checkout -b [分支名]
```
#### 10.4合并分支
```
$ git merge [分支名]
```
将目标分支的内容合并到当前分支
#### 10.5删除分支
```
$ git branch -d [分支名]
```

### 十一.分支冲突
当使用merge合并两个分支的时候,如果存在两个同名当时内容不同的文件时,Git就无法自动合并.
这个时候就需要手动修改分支中的内容,消除不一致之后才可以合并.

### 十二.多人协作
当多个人同时对一个远程仓库进行提交操作的时候.后提交者在提交会Git会提示提交有冲突.
可以先使用`Git pull`把最新的提交抓下来,自动本地合.然后再次用push提交.